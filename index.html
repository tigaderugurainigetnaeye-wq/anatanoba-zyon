<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>あなたの機種は〜です！</title>
  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans JP", sans-serif;
      background: #f8fafc;
      color: #1e293b;
      line-height: 1.6;
    }
    header {
      text-align: center;
      padding: 2rem 1rem 1rem;
      background: #0ea5e9;
      color: white;
      border-bottom-left-radius: 1rem;
      border-bottom-right-radius: 1rem;
    }
    header h1 {
      font-size: 1.8rem;
      margin: 0;
    }
    header p {
      font-size: 0.9rem;
      opacity: 0.9;
      margin-top: 0.5rem;
    }
    .container {
      max-width: 960px;
      margin: auto;
      padding: 1rem;
    }
    .card {
      background: white;
      border-radius: 1rem;
      padding: 1.5rem;
      margin-bottom: 1rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .info-item {
      display: flex;
      justify-content: space-between;
      padding: 0.6rem 0;
      border-bottom: 1px solid #e2e8f0;
    }
    .info-item:last-child {
      border-bottom: none;
    }
    .info-label {
      color: #64748b;
      font-size: 0.9rem;
    }
    .info-value {
      font-weight: 600;
      color: #1e293b;
    }
    .buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-top: 1rem;
    }
    button {
      flex: 1;
      min-width: 120px;
      background: #e2e8f0;
      border: none;
      border-radius: 0.5rem;
      color: #1e293b;
      padding: 0.6rem;
      cursor: pointer;
      transition: background 0.2s;
    }
    button:hover {
      background: #cbd5e1;
    }
    button.primary {
      background: #0ea5e9;
      color: white;
      font-weight: 600;
    }
    pre {
      background: #f1f5f9;
      padding: 1rem;
      border-radius: 0.5rem;
      overflow-x: auto;
      font-size: 0.85rem;
    }
    footer {
      text-align: center;
      font-size: 0.8rem;
      color: #64748b;
      padding: 2rem 1rem;
    }
    @media (max-width: 600px) {
      header h1 {
        font-size: 1.3rem;
      }
      .info-item {
        flex-direction: column;
        align-items: flex-start;
      }
      .info-value {
        margin-top: 0.2rem;
      }
      .buttons {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <header>
    <h1>あなたの機種は <span id="deviceTitle">—</span> です！</h1>
    <p>このページはブラウザから取得した情報をもとに表示しています。</p>
  </header>

  <div class="container">
    <div class="card">
      <div class="info-item"><div class="info-label">デバイスタイプ</div><div class="info-value" id="deviceType">—</div></div>
      <div class="info-item"><div class="info-label">ブラウザ / バージョン</div><div class="info-value" id="browser">—</div></div>
      <div class="info-item"><div class="info-label">OS</div><div class="info-value" id="os">—</div></div>
      <div class="info-item"><div class="info-label">画面解像度</div><div class="info-value" id="screen">—</div></div>
      <div class="info-item"><div class="info-label">言語 / タイムゾーン</div><div class="info-value" id="langtz">—</div></div>
      <div class="info-item"><div class="info-label">CPU コア</div><div class="info-value" id="cores">—</div></div>
      <div class="info-item"><div class="info-label">オンライン状態</div><div class="info-value" id="online">—</div></div>
      <div class="buttons">
        <button id="refreshBtn">再読み込み</button>
        <button id="copyBtn">情報をコピー</button>
        <button id="downloadBtn" class="primary">JSON ダウンロード</button>
      </div>
    </div>

    <div class="card">
      <div class="info-label">ユーザーエージェント</div>
      <pre id="ua">—</pre>
    </div>

    <div class="card" id="extra"></div>
  </div>

  <footer>
    表示される情報はブラウザが提供するもので、端末や環境によって異なる場合があります。
  </footer>

  <script>
    function parseBrowser(ua){
      const rules = [
        [/Edg\/(\d+\.\d+)/,'Edge'],
        [/OPR\/(\d+\.\d+)/,'Opera'],
        [/Chrome\/(\d+\.\d+)/,'Chrome'],
        [/Firefox\/(\d+\.\d+)/,'Firefox'],
        [/Version\/(\d+\.\d+).*Safari/,'Safari'],
        [/Safari\/(\d+\.\d+)/,'Safari']
      ];
      for(const [r,name] of rules){
        const m = ua.match(r);
        if(m) return name + ' ' + m[1];
      }
      return '不明';
    }
    function parseOS(ua){
      if(/Windows NT 10/.test(ua)) return 'Windows 10/11';
      if(/Windows NT 6\.3/.test(ua)) return 'Windows 8.1';
      if(/Windows NT 6\.2/.test(ua)) return 'Windows 8';
      if(/Windows NT 6\.1/.test(ua)) return 'Windows 7';
      if(/Windows NT 6\.0/.test(ua)) return 'Windows Vista';
      if(/Windows NT 5\.1/.test(ua)) return 'Windows XP';
      if(/Win64|Windows/.test(ua)) return 'Windows (バージョン不明)';
      if(/Android/.test(ua)) return 'Android';
      if(/iPhone|iPad|iPod/.test(ua)) return 'iOS';
      if(/Mac OS X/.test(ua)) return 'macOS';
      if(/Linux/.test(ua)) return 'Linux';
      return '不明';
    }
    function deviceType(ua){
      if(/Mobi|Android|iPhone|iPod/.test(ua)) return 'スマホ';
      if(/iPad|Tablet/.test(ua)) return 'タブレット';
      return 'PC';
    }
    async function getBattery(){
      if(navigator.getBattery) {
        try{ const b = await navigator.getBattery(); return {charging:b.charging, level: Math.round(b.level*100)} }catch(e){}
      }
      return null;
    }
    function gather(){
      const ua = navigator.userAgent;
      return {
        ua,
        browser: parseBrowser(ua),
        os: parseOS(ua),
        deviceType: deviceType(ua),
        screen: `${screen.width} x ${screen.height}`,
        language: navigator.language,
        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
        cores: navigator.hardwareConcurrency || '不明',
        online: navigator.onLine ? 'オンライン' : 'オフライン'
      };
    }
    async function render(){
      const info = gather();
      document.getElementById('deviceTitle').textContent = info.os + ' ' + info.deviceType;
      document.getElementById('deviceType').textContent = info.deviceType;
      document.getElementById('browser').textContent = info.browser;
      document.getElementById('os').textContent = info.os;
      document.getElementById('screen').textContent = info.screen;
      document.getElementById('langtz').textContent = info.language + ' / ' + info.timezone;
      document.getElementById('cores').textContent = info.cores;
      document.getElementById('online').textContent = info.online;
      document.getElementById('ua').textContent = info.ua;
      const extra = document.getElementById('extra');
      extra.innerHTML = '';
      const battery = await getBattery();
      if(battery){
        extra.innerHTML += `<div class="info-item"><div class="info-label">バッテリー</div><div class="info-value">${battery.level}% (${battery.charging? '充電中':'未充電'})</div></div>`;
      }
    }
    document.getElementById('refreshBtn').addEventListener('click', render);
    document.getElementById('copyBtn').addEventListener('click', async ()=>{
      const j = gather();
      try{ await navigator.clipboard.writeText(JSON.stringify(j,null,2)); alert('コピーしました'); }catch(e){ alert('コピーに失敗しました'); }
    });
    document.getElementById('downloadBtn').addEventListener('click', async ()=>{
      const j = gather();
      const blob = new Blob([JSON.stringify(j,null,2)],{type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'device-info.json';
      a.click();
      URL.revokeObjectURL(url);
    });
    render();
  </script>
</body>
</html>
